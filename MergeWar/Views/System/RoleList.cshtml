@using System.Collections.Generic
@using Common
@using HCZZ.ModeDB
@using Webdiyer.WebControls.Mvc
@model PagedList<Sys_UserPowerInfo> 
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "系统设置-角色管理";
    string relaVal = ChangeValue.RefPageRelaByPath("System/UserList");
    Dictionary<string, string> dic = (Dictionary<string, string>) ViewBag.dic;
}
<!DOCTYPE html>
<html>
<head>
    <title>角色管理</title>
</head>
<script src="@Url.Content("~/Content/DatePicker/WdatePicker.js")" type="text/javascript"></script>
<link href="@Url.Content("~/Content/css/XTGL.css")" rel="stylesheet" type="text/css" />
<body>
<form id="form1" action="@Url.Content("~/System/RoleList")" method="GET">
    <div class="contentbody" id="contentbody">
    <div class="contentTitle">
        <span>查询条件和按钮区</span>
        <input class="search" type="button" id="BtnSelect" onclick="myFunction(this, 'contentConditions')"
               value="隐藏"/>
        @if (relaVal.Contains("2"))
        {
            <input class="add" type="button" id="" value="+ 添加" onclick="PublicFun(1,'System/AddRole')"/>
        }
    </div>
    <div class="contentConditions" style="height: 70px">
        <ul>
            <li class="Conditions Conditions5"><span>创建时间：</span>
                <input type="text" name="CreateTime" id="CreateTime" value="@dic["CreateTime"]" onfocus="WdatePicker({ dateFmt: 'yyyy-MM-dd HH:mm:ss', readonly: true, maxDate: '#F{$dp.$D(\'EndTime\')}' })"/>
                ---
                <input type="text" name="EndTime" id="EndTime" value="@dic["EndTime"]" onfocus="WdatePicker({ dateFmt: 'yyyy-MM-dd HH:mm:ss', readonly: true, minDate: '#F{$dp.$D(\'CreateTime\')}' })"/>
            </li>
            <li class="Conditions Conditions4"><span>角色名：</span>
                <input type="text" id="keyword" name="keyword" value="@dic["txtkeyword"]"/>
            </li>
            <li class="Conditions Conditions6">
                <input class="selectbg" type="submit" id="but_Seek" value="搜索"/>
                <input class="resetbg" type="reset" value="重置" onclick="Reset()"/>
            </li>
        </ul>
    </div>
    <div class="contentTable" id="taskManagementId">
        <table border="0" cellspacing="0" cellpadding="0">
            <tr>
                <th>
                    角色名称
                </th>
                <th>
                    创建时间
                </th>
                <th>
                    角色权限
                </th>
                <th>
                    操作
                </th>
            </tr>
            @{
                if (Model != null && Model.Count > 0)
                {
                    foreach (Sys_UserPowerInfo item in Model)
                    {
                        <tr>
                            <td>@item.RoleName
                            </td>
                            <td>@ChangeValue.RefFormatTimeToString(item.CreateTime, "ss")
                            </td>
                            <td>
                                @if (item.JNum > 0)
                                {
                                    <a href="@Url.Content("~/System/EditPower/" + item.Jid)">修改权限</a>}
                                else
                                {
                                    <a href="@Url.Content("~/System/AddPower/" + item.Jid)" style="color: Red">添加权限</a>
                                }
                            </td>
                            <td>
                                @if (item.RoleName != "管理员")
                                {
                                    <a href="@Url.Content("~/System/EditRole?Jid=" + item.Jid)" class="Cz_xiugai">编辑</a>
                                    <a href="javascript:void(0)" @(item.JUserNum > 0 ? "style=color:gray; title=该角色下存在" + item.JUserNum + "个用户，不能删除！" : "onclick=PublicFun(" + 2 + ",'System/DelRole?Jid=" + item.Jid + "')") class="Cz_xiugai">
                                        删除</a>
                                }
                                else
                                {
                                    <kbd>--</kbd>
                                }
                            </td>
                        </tr>
                    }
                }
                @*else
                {
                    <table>
                        <tr>
                            <td colspan="4">
                                暂无可显示数据
                            </td>
                        </tr>
                    </table>
                }*@
            }
        </table>
        <div class="page">
            <ul class="ulPage">
                @Ajax.Pager(Model, new PagerOptions
           {
               FirstPageText = "首页",
               PrevPageText = "上一页",
               NextPageText = "下一页",
               LastPageText = "尾页",
               PageIndexParameterName = "PageIndex",
               NavigationPagerItemTemplate = "<li class=\"liPage\" style=\"width: 42px; \">{0}</li>",
               NumericPagerItemTemplate = "<li class=\"liPage\" style=\"width: 42px; \">{0}</li>",
               ShowMorePagerItems = false,
           }).AjaxOptions(a => a.SetUpdateTargetId("taskManagementId"))
                <li class="contPage">共<span>@Model.TotalPageCount</span>页/共<span>@Model.TotalItemCount</span>条</li>
            </ul>
        </div>
    </div>
</div>
</form>

<script type="text/javascript">
    function InputVerify() {
        var res = false;
        $(".contentConditions").find("input[type='text']").each(function(){
            if ($.trim($(this).val())!=""){
                res = true;
            }
        });
        return res;
    }
    $("#form1").submit(function () {
        if (InputVerify() === true) {
            return InputVerify();
        } else {
            alert("请输入搜索条件！");
            return false;
        }
    });
</script>
</body>
</html>